<!DOCTYPE html>
<html>
<head>

<!--  JQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

<!-- Bootstrap -->
<script type='text/javascript' src='js/bootstrap.js'></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

<!-- Leaflet -->
 <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
 <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>


<!-- Start of CSS -->
<style>
body {
  padding-top: 50px;
  padding-bottom: 50px;
}

.col-sm-4 {
/*  border: 1px solid red;*/
}

.col-sm-8 {
/*  border: 1px solid black;*/
}

#mapid {
    height: 600px;
}


.title {
  padding: 40px 15px;
  text-align: center;
}

li.list-group-item {
  border: none;
}

.col-xs-3 {
  border: none;
}
.container h3 {
  text-align: center;
}

</style>
<!-- End of CSS -->

</head>

<!-- Start of HTML -->
<body>
<div class="title">
  <h1>Early Access User Geomapper</h1>
    <h3> This application is a MarkLogic-based visualization that provides an "executive" display for locations of all MarkLogic 9 Early Access users.</h3>
</div>

<div class="container"><div class="row">
  <div class="col-sm-4">
    <h3>Features</h3><br>

<!-- Select Dates button -->
<!--     <div class="col-xs-12">
      <button type="button" class="btn btn-default btn-lg" style="text-align:center">Select Dates</button>
    </div> -->
    
    <div class="col-xs-6">
      <div class="panel-group" id="accordion">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title"><a data-toggle="collapse" href="#">Select Dates</a></h4>
          </div>
        </div>
      </div>
    </div>

    <div class="col-xs-6">
      <div class="panel-group" id="accordion">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title"><a data-toggle="collapse" href="#">Draw Region</a></h4>
          </div>
        </div>
      </div>
    </div>

    <br><br><br>

<!-- Select Industry -->

<!-- code to find all industries -->
<!-- <script>
var jsearch = require('/Marklogic/jsearch.sjs');
  jsearch.facets([jsearch.facet('Industry', 'industry').slice(0, 215)]).result()
</script> -->

    <div class="col-xs-6">
      <div class="panel-group" id="accordion">
        <div class="panel panel-default">
          <div class="panel-heading">
<!--             <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapse1">Select Industry</a></h4> -->
            <h4 class="panel-title"><a data-toggle="collapse" href="#collapse1">Select Industry</a></h4>
          </div>
          <div id="collapse1" class="panel-collapse collapse">
            <ul class="list-group">
              <li class="list-group-item"><input type="checkbox" onclick="handleClick(this);"> i_1 </li>
              <li class="list-group-item"><input type="checkbox" value=""> i_2 </li>
            </ul>
          </div>
        </div>
      </div>
    </div>


<!-- Functions -->
<script>

function handleClick(cb) {
  // get the user(s)
  var jsearch = require('/Marklogic/jsearch.sjs');
  var results =
    jsearch.facets(
      jsearch.facet('Industry', 'industry'),
      jsearch.documents().map({snippet: false, extract: {select: 'all'}}))
        .where(jsearch.byExample({city: 'i_1'}))
      .result('iterator')
    //.result()

  // display user(s) on map
  L.geoJson(results).addTo(mymap);
  }
</script>


<!-- Select Features -->

<!-- code to find all features -->
<!-- <script>
var jsearch = require('/Marklogic/jsearch.sjs');
  jsearch.facets([jsearch.facet('Feature', 'feature').slice(0, 215)]).result()
</script> -->

    <div class="col-xs-6">
      <div class="panel-group" id="accordion">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title"><a data-toggle="collapse" href="#collapse2">Select Feature</a></h4>
          </div>
          <div id="collapse2" class="panel-collapse collapse">
            <ul class="list-group">
              <li class="list-group-item"><input type="checkbox" value=""> Feature 1</li>
              <li class="list-group-item"><input type="checkbox" value=""> Feature 2</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

<br><br><br>

<!--     <div class="col-xs-12">
      <button type="button" class="btn btn-default btn-lg" style="text-align:center">Draw Regions</button>
    </div> -->

  </div>

<!--  Map -->

  <div class="col-sm-8">
    <h3>Map Display</h3><br>
    <div id="mapid">
  </div>

  <!-- Displaying the map (in JS) -->
  <script>
   var mymap = L.map('mapid').setView([37.766579, -122.230758], 13);

  L.tileLayer('https://api.mapbox.com/styles/v1/liangdanica/ciqcx4m59003pbzm9p53mvq36/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoibGlhbmdkYW5pY2EiLCJhIjoiY2lxY3gzeG95MDJkbmZubmUzYmxicW5kMSJ9.5p2qxjIuC7exMGGm19XFeg', {
      attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',
      maxZoom: 18,
      id: 'Basic',
      accessToken: 'pk.eyJ1IjoibGlhbmdkYW5pY2EiLCJhIjoiY2lxY3gzeG95MDJkbmZubmUzYmxicW5kMSJ9.5p2qxjIuC7exMGGm19XFeg'
  }).addTo(mymap);


  // L.tileLayer('https://api.mapbox.com/styles/v1/liangdanica/ciqcx4m59003pbzm9p53mvq36/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoibGlhbmdkYW5pY2EiLCJhIjoiY2lxY3gzeG95MDJkbmZubmUzYmxicW5kMSJ9.5p2qxjIuC7exMGGm19XFeg', {
  //     attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',
  //     maxZoom: 18,
  //     id: 'Basic',
  //     accessToken: 'pk.eyJ1IjoibGlhbmdkYW5pY2EiLCJhIjoiY2lxY3gzeG95MDJkbmZubmUzYmxicW5kMSJ9.5p2qxjIuC7exMGGm19XFeg'
  // }).addTo(mymap);

var geojsonFeature = [{
    "type": "Feature",
    "properties": {
        "name": "Coors Field",
        "amenity": "Baseball Stadium",
        "popupContent": "This is where the Rockies play!"
    },
    "geometry": {
        "type": "Point",
        "coordinates": [-107.290283, 43.075970]
    }
},
{
    "type": "Feature",
    "properties": {
        "name": "Litchfield Prison",
        "amenity": "Prison",
        "popupContent": "Inmates are housed here!"
    },
    "geometry": {
        "type": "Point",
        "coordinates": [-95.366302, 29.761993]
    }

}];

L.geoJson(geojsonFeature).addTo(mymap);

  var marker = L.marker([37.766579, -122.230758]).addTo(mymap);

  // marker.bindPopup("<b>Hello world!</b><br>I am a popup.").openPopup();

  var popup = L.popup();

function onMapClick(e) {
    popup
        .setLatLng([37.766579, -122.230758])
        .setContent("You clicked the map at " + e.latlng.toString())
        .openOn(mymap);
}
mymap.on('click', onMapClick);

  </script>
</div></div>

</body>
</html>